<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      layout:decorate="~{layout}">


<th:block layout:fragment="script">
    <script th:inline="javascript">
        $(document).ready(function (){
           $('#content-area img').each(function (){
              $(this).addClass("img-fluid");
           });
        });
    </script>
</th:block>

<div layout:fragment="content">
    <div id="post-area">
        <span class="badge badge-secondary float-right" th:if="${postDTO.categoryDTO != null}" th:text="${postDTO.categoryDTO.name}"></span>
        <span class="badge badge-secondary float-right" th:unless="${postDTO.categoryDTO != null}">미분류</span>

        <!-- Title -->
        <h1 class="mt-4" th:text="${postDTO.title}"></h1>
        <h5 class="text-muted" th:text="${postDTO.hook_text}"></h5>

        <!-- 작성자 -->
        <p class="lead">
            by <a href="#" th:text="${postDTO.writer}"></a>
        </p>

        <hr/>
        <!-- 포스트 수정 버튼 -->
        <a sec:authorize="isAuthenticated()" th:if="${#authentication.principal.Nick == postDTO.writer}" class="btn btn-info btn-sm float-right" role="button">
            <i class="fas fa-pen"></i> 포스트 수정
        </a>

        <!-- 작성날짜 -->
        <p th:text="'Posted on ' + ${postDTO.postDate}"></p>

        <hr />

        <!--헤드 이미지-->
        <img class="img-fluid rounded" th:if="${postDTO.headImgUrl != null}" th:src="${postDTO.headImgUrl}" />
        <img class="img-fluid rounded" th:unless="${postDTO.headImgUrl != null}" th:src="'https://picsum.photos/seed/' + ${postDTO.postId} + '/800/200'" />

        <hr/>
        <!-- 본문 -->
        <div id="content-area" th:utext="${postDTO.content}"></div>
        <br /><br />

        <!-- 태그영역 -->
        <th:block th:if="${postDTO.tags != null}">
            <i class="fas fa-tags"></i>
            <th:block th:each="tag:${postDTO.tags}">
                <a href="#">
                    <span class="badge badge-pill badge-light" th:text="${tag}"></span>
                </a>
            </th:block>
            <br /><br />
        </th:block>

        <!-- 첨부파일 -->
        <a th:href="@{/ajax/fileDownload(url=${postDTO.attachedFileUrl}, orgFileName=${postDTO.attachedFileName})}" th:if="${postDTO.attachedFileUrl != null}" class="btn btn-outline-dark" role="button" download>
            <i class="fa fa-file"></i> [[${postDTO.attachedFileName}]]
        </a>
        <hr />
    </div>

    <!-- 댓글창 -->
    <div id="comment-area">

    </div>

</div>

</html>